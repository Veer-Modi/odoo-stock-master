========================================
PASSWORD RESET WITH OTP - IMPLEMENTATION
========================================

COMPLETED IMPLEMENTATION:
-------------------------

✅ Backend Setup (NodeMailer + OTP)
✅ Frontend Integration
✅ Email Service Configuration
✅ Database Schema Updates
✅ Security Features

FILES CREATED/MODIFIED:
-----------------------

BACKEND FILES CREATED:
1. server.js - Main Express server
2. routes/auth.js - Authentication routes (register, login, forgot-password, reset-password)
3. models/User.js - User model with OTP fields
4. utils/emailService.js - NodeMailer email sending service
5. .env - Environment configuration (EMAIL CREDENTIALS REQUIRED)
6. .env.example - Example environment variables

FRONTEND FILES MODIFIED:
1. src/pages/ForgotPassword.jsx - Connected to backend API

BACKEND PACKAGE.JSON UPDATED:
- Added nodemailer dependency
- Added start and dev scripts

FEATURES IMPLEMENTED:
--------------------

1. OTP GENERATION
   - 6-digit random OTP
   - Generated on forgot-password request
   - Stored in database with user record

2. EMAIL SENDING (NodeMailer)
   - Professional HTML email template
   - OTP prominently displayed
   - Security warnings included
   - 10-minute expiry notice
   - Configurable SMTP settings

3. OTP VALIDATION
   - Checks OTP exists
   - Verifies OTP matches
   - Checks expiry time (10 minutes)
   - Single-use (cleared after reset)

4. SECURITY FEATURES
   - Password hashing with bcrypt
   - JWT authentication
   - OTP expiry (10 minutes)
   - Email validation
   - Secure password storage

5. ERROR HANDLING
   - User not found
   - Invalid OTP
   - Expired OTP
   - Email sending failures
   - Network errors

API ENDPOINTS:
--------------

POST /api/auth/forgot-password
Body: { email: "user@example.com" }
Response: { message: "OTP sent successfully to your email", email: "user@example.com" }

POST /api/auth/reset-password
Body: { email: "user@example.com", otp: "123456", newPassword: "newpass123" }
Response: { message: "Password reset successful" }

POST /api/auth/register (bonus)
Body: { email: "user@example.com", password: "pass123", name: "John Doe" }
Response: { message: "User registered successfully", token: "jwt_token", user: {...} }

POST /api/auth/login (bonus)
Body: { email: "user@example.com", password: "pass123" }
Response: { message: "Login successful", token: "jwt_token", user: {...} }

WORKFLOW:
---------

1. User clicks "Forgot Password"
2. Enters email address
3. Frontend calls POST /api/auth/forgot-password
4. Backend:
   - Finds user by email
   - Generates 6-digit OTP
   - Saves OTP + expiry to database
   - Sends email via NodeMailer
5. User receives email with OTP
6. User enters OTP and new password
7. Frontend calls POST /api/auth/reset-password
8. Backend:
   - Validates OTP
   - Checks expiry
   - Hashes new password
   - Updates user record
   - Clears OTP
9. User redirected to login
10. User logs in with new password

NEXT STEPS TO RUN:
------------------

1. Install MongoDB and start the service
2. Update backend/.env with your email credentials:
   - EMAIL_USER=your-email@gmail.com
   - EMAIL_PASSWORD=your-app-password
   - EMAIL_FROM=StockMaster <your-email@gmail.com>

3. Start backend:
   cd backend
   npm run dev

4. Start frontend (in new terminal):
   cd frontend
   npm start

5. Test the flow:
   - Register a user (if needed)
   - Go to Forgot Password
   - Enter email
   - Check email inbox
   - Enter OTP and new password
   - Login with new password

EMAIL PROVIDERS SUPPORTED:
--------------------------
- Gmail (recommended, with App Password)
- Outlook/Hotmail
- Yahoo Mail
- Custom SMTP servers
- SendGrid
- Mailgun
- Any SMTP-compatible service

CONFIGURATION REQUIRED:
-----------------------
Update these in backend/.env:
- EMAIL_HOST (e.g., smtp.gmail.com)
- EMAIL_PORT (e.g., 587)
- EMAIL_USER (your email)
- EMAIL_PASSWORD (app password)
- EMAIL_FROM (sender name and email)

For Gmail:
1. Enable 2-Step Verification
2. Generate App Password at: https://myaccount.google.com/apppasswords
3. Use the 16-digit password (no spaces)

That's it! The password reset with OTP via NodeMailer is fully implemented and ready to use.
